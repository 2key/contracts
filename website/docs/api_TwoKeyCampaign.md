---
id: TwoKeyCampaign
title: TwoKeyCampaign
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> TwoKeyCampaign</h2><p class="base-contracts"><span>is</span> <a href="TwoKeyARC.html">TwoKeyARC</a><span>, </span><a href="ComposableAssetFactory.html">ComposableAssetFactory</a><span>, </span><a href="TwoKeyTypes.html">TwoKeyTypes</a></p><div class="source">Source: <a href="git+https://github.com/2keynet/web3-alpha/blob/v0.0.1/contracts/TwoKeyCampaign.sol" target="_blank">TwoKeyCampaign.sol</a></div></div><div class="index"><h2>Index</h2><ul><li><a href="TwoKeyCampaign.html#actuallyFulfilledTwoKeyToken">actuallyFulfilledTwoKeyToken</a></li><li><a href="TwoKeyCampaign.html#buyFromWithTwoKey">buyFromWithTwoKey</a></li><li><a href="TwoKeyCampaign.html#calculateModeratorFee">calculateModeratorFee</a></li><li><a href="TwoKeyCampaign.html#cancelFungibleAssetTwoKey">cancelFungibleAssetTwoKey</a></li><li><a href="TwoKeyCampaign.html#cancelNonFungibleAssetTwoKey">cancelNonFungibleAssetTwoKey</a></li><li><a href="TwoKeyCampaign.html#cancelledFungibleEscrow">cancelledFungibleEscrow</a></li><li><a href="TwoKeyCampaign.html#cancelledNonFungibleEscrow">cancelledNonFungibleEscrow</a></li><li><a href="TwoKeyCampaign.html#didConverterConvert">didConverterConvert</a></li><li><a href="TwoKeyCampaign.html#expireEscrowFungible">expireEscrowFungible</a></li><li><a href="TwoKeyCampaign.html#expireEscrowNonFungible">expireEscrowNonFungible</a></li><li><a href="TwoKeyCampaign.html#">fallback</a></li><li><a href="TwoKeyCampaign.html#fulfillFungibleTwoKeyToken">fulfillFungibleTwoKeyToken</a></li><li><a href="TwoKeyCampaign.html#fulfillNonFungibleTwoKeyToken">fulfillNonFungibleTwoKeyToken</a></li><li><a href="TwoKeyCampaign.html#isWhiteListedInfluencer">isWhiteListedInfluencer</a></li><li><a href="TwoKeyCampaign.html#isWhitelistedConverter">isWhitelistedConverter</a></li><li><a href="TwoKeyCampaign.html#redeemTwoKeyToken">redeemTwoKeyToken</a></li><li><a href="TwoKeyCampaign.html#setPriceFungible">setPriceFungible</a></li><li><a href="TwoKeyCampaign.html#setPriceNonFungible">setPriceNonFungible</a></li><li><a href="TwoKeyCampaign.html#transferFungibleAssetTwoKeyToken">transferFungibleAssetTwoKeyToken</a></li><li><a href="TwoKeyCampaign.html#transferNonFungibleAssetTwoKeyToken">transferNonFungibleAssetTwoKeyToken</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="modifiers"><h3>Modifiers</h3><ul><li><div class="item modifier"><span id="didConverterConvert" class="anchor-marker"></span><h4 class="name">didConverterConvert</h4><div class="body"><code class="signature">modifier <strong>didConverterConvert</strong><span>() </span></code><hr/></div></div></li><li><div class="item modifier"><span id="isWhiteListedInfluencer" class="anchor-marker"></span><h4 class="name">isWhiteListedInfluencer</h4><div class="body"><code class="signature">modifier <strong>isWhiteListedInfluencer</strong><span>() </span></code><hr/></div></div></li><li><div class="item modifier"><span id="isWhitelistedConverter" class="anchor-marker"></span><h4 class="name">isWhitelistedConverter</h4><div class="body"><code class="signature">modifier <strong>isWhitelistedConverter</strong><span>() </span></code><hr/></div></div></li></ul></div><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="actuallyFulfilledTwoKeyToken" class="anchor-marker"></span><h4 class="name">actuallyFulfilledTwoKeyToken</h4><div class="body"><code class="signature">function <strong>actuallyFulfilledTwoKeyToken</strong><span>() </span><span>internal </span></code><hr/><div class="description"><p>Calculates moderetor fee, pays the moderator, computes total reward transfer payout to contractor, deducting the fee and the total reward asks the campaign to distribute rewards to influencers.</p></div></div></div></li><li><div class="item function"><span id="buyFromWithTwoKey" class="anchor-marker"></span><h4 class="name">buyFromWithTwoKey</h4><div class="body"><code class="signature">function <strong>buyFromWithTwoKey</strong><span>(address _from, uint256 _tokenID, address _assetContract, uint256 _amountOrIndex, CampaignType _campaignType) </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Buy product with twokey token, _from is the influencer from which you received the referral _tokenID is the asset sku _assetContract - erc20 (fungible) or erc721 (non fungible) which represents the class of the asset _amountOrIndex - for erc20 amount in asset class, for erc21 index within asset class.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_from</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_amountOrIndex</code> - uint256</div><div><code>_campaignType</code> - CampaignType</div></dd></dl></div></div></li><li><div class="item function"><span id="calculateModeratorFee" class="anchor-marker"></span><h4 class="name">calculateModeratorFee</h4><div class="body"><code class="signature">function <strong>calculateModeratorFee</strong><span>(uint256 _payout) </span><span>internal </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Given the total payout, calculates the moderator fee.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_payout</code> - total payout for escrow</div></dd><dt><span class="label-return">Returns:</span></dt><dd>moderator fee</dd></dl></div></div></li><li><div class="item function"><span id="cancelFungibleAssetTwoKey" class="anchor-marker"></span><h4 class="name">cancelFungibleAssetTwoKey</h4><div class="body"><code class="signature">function <strong>cancelFungibleAssetTwoKey</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _amount) </span><span>public </span><span>returns  (bool) </span></code><hr/><div class="description"><p>CancelFungibleAssetTwoKey cancels the purchase buy transfering the assets back to the campaign and refunding the converter.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - sku of asset</div><div><code>_assetContract</code> - erc20 representing the asset class</div><div><code>_amount</code> - amount of asset bought  </div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="cancelNonFungibleAssetTwoKey" class="anchor-marker"></span><h4 class="name">cancelNonFungibleAssetTwoKey</h4><div class="body"><code class="signature">function <strong>cancelNonFungibleAssetTwoKey</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _assetTokenID) </span><span>public </span><span>returns  (bool) </span></code><hr/><div class="description"><p>CancelNonFungibleAssetTwoKey cancels the purchase buy transfering the assets back to the campaign and refunding the converter.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - sku of asset</div><div><code>_assetContract</code> - erc721 representing the asset class</div><div><code>_assetTokenID</code> - unique index of asset  </div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="cancelledFungibleEscrow" class="anchor-marker"></span><h4 class="name">cancelledFungibleEscrow</h4><div class="body"><code class="signature">function <strong>cancelledFungibleEscrow</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _amount) </span><span>internal </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_amount</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="cancelledNonFungibleEscrow" class="anchor-marker"></span><h4 class="name">cancelledNonFungibleEscrow</h4><div class="body"><code class="signature">function <strong>cancelledNonFungibleEscrow</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _assetTokenID) </span><span>internal </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_assetTokenID</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="expireEscrowFungible" class="anchor-marker"></span><h4 class="name">expireEscrowFungible</h4><div class="body"><code class="signature">function <strong>expireEscrowFungible</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _amount) </span><span>public </span><span>returns  (bool) </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_amount</code> - uint256</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="expireEscrowNonFungible" class="anchor-marker"></span><h4 class="name">expireEscrowNonFungible</h4><div class="body"><code class="signature">function <strong>expireEscrowNonFungible</strong><span>(address _converter, uint256 _tokenID, address _assetContract, uint256 _assetTokenID) </span><span>public </span><span>returns  (bool) </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_converter</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_assetTokenID</code> - uint256</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="fallback" class="anchor-marker"></span><h4 class="name">fallback</h4><div class="body"><code class="signature">function <strong></strong><span>(TwoKeyEventSource _eventSource, TwoKeyEconomy _economy, TwoKeyWhitelisted _whitelistInfluencer, TwoKeyWhitelisted _whitelistConverter, address _contractor, address _moderator, uint256 _openingTime, uint256 _closingTime, uint256 _expiryConversion, uint256 _escrowPrecentage, uint256 _rate, uint256 _maxPi) </span><span>public </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_eventSource</code> - TwoKeyEventSource</div><div><code>_economy</code> - TwoKeyEconomy</div><div><code>_whitelistInfluencer</code> - TwoKeyWhitelisted</div><div><code>_whitelistConverter</code> - TwoKeyWhitelisted</div><div><code>_contractor</code> - address</div><div><code>_moderator</code> - address</div><div><code>_openingTime</code> - uint256</div><div><code>_closingTime</code> - uint256</div><div><code>_expiryConversion</code> - uint256</div><div><code>_escrowPrecentage</code> - uint256</div><div><code>_rate</code> - uint256</div><div><code>_maxPi</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="fulfillFungibleTwoKeyToken" class="anchor-marker"></span><h4 class="name">fulfillFungibleTwoKeyToken</h4><div class="body"><code class="signature">function <strong>fulfillFungibleTwoKeyToken</strong><span>(address _from, uint256 _tokenID, address _assetContract, uint256 _amount) </span><span>internal </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="ComposableAssetFactory.html#isOngoing">isOngoing </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_from</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_amount</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="fulfillNonFungibleTwoKeyToken" class="anchor-marker"></span><h4 class="name">fulfillNonFungibleTwoKeyToken</h4><div class="body"><code class="signature">function <strong>fulfillNonFungibleTwoKeyToken</strong><span>(address _from, uint256 _tokenID, address _assetContract, uint256 _index) </span><span>internal </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="ComposableAssetFactory.html#isOngoing">isOngoing </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_from</code> - address</div><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_index</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="redeemTwoKeyToken" class="anchor-marker"></span><h4 class="name">redeemTwoKeyToken</h4><div class="body"><code class="signature">function <strong>redeemTwoKeyToken</strong><span>(uint256 _amount) </span><span>public </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_amount</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="setPriceFungible" class="anchor-marker"></span><h4 class="name">setPriceFungible</h4><div class="body"><code class="signature">function <strong>setPriceFungible</strong><span>(uint256 _tokenID, address _assetContract, uint256 _pricePerUnit) </span><span>public </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_pricePerUnit</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="setPriceNonFungible" class="anchor-marker"></span><h4 class="name">setPriceNonFungible</h4><div class="body"><code class="signature">function <strong>setPriceNonFungible</strong><span>(uint256 _tokenID, address _assetContract, uint256 _index, uint256 _pricePerUnit) </span><span>public </span></code><hr/><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="openzeppelin-solidity_contracts_access_rbac_RBAC.html#onlyRole">onlyRole </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_tokenID</code> - uint256</div><div><code>_assetContract</code> - address</div><div><code>_index</code> - uint256</div><div><code>_pricePerUnit</code> - uint256</div></dd></dl></div></div></li><li><div class="item function"><span id="transferFungibleAssetTwoKeyToken" class="anchor-marker"></span><h4 class="name">transferFungibleAssetTwoKeyToken</h4><div class="body"><code class="signature">function <strong>transferFungibleAssetTwoKeyToken</strong><span>(uint256 _tokenID, address _assetContract, uint256 _amount) </span><span>public </span></code><hr/><div class="description"><p>TransferFungibleAssetTwoKeyToken.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="TwoKeyCampaign.html#isWhitelistedConverter">isWhitelistedConverter </a><a href="TwoKeyCampaign.html#didConverterConvert">didConverterConvert </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_tokenID</code> - sku of asset</div><div><code>_assetContract</code> - erc20 representing the asset class</div><div><code>_amount</code> - amount of asset bought  * transfer the asset to the converter,</div></dd></dl></div></div></li><li><div class="item function"><span id="transferNonFungibleAssetTwoKeyToken" class="anchor-marker"></span><h4 class="name">transferNonFungibleAssetTwoKeyToken</h4><div class="body"><code class="signature">function <strong>transferNonFungibleAssetTwoKeyToken</strong><span>(uint256 _tokenID, address _assetContract, uint256 _assetTokenID) </span><span>public </span></code><hr/><div class="description"><p>TransferNonFungibleAssetTwoKeyToken.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="TwoKeyCampaign.html#isWhitelistedConverter">isWhitelistedConverter </a><a href="TwoKeyCampaign.html#didConverterConvert">didConverterConvert </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_tokenID</code> - sku of asset</div><div><code>_assetContract</code> - erc721 representing the asset class</div><div><code>_assetTokenID</code> - unique index of asset  * transfer the asset to the converter,</div></dd></dl></div></div></li></ul></div></div></div>
