---
id: 2key_singleton-contracts_TwoKeyUpgradableExchange
title: TwoKeyUpgradableExchange
---

<div class="contract-doc"><div class="contract"><h2 class="contract-header"><span class="contract-kind">contract</span> TwoKeyUpgradableExchange</h2><p class="base-contracts"><span>is</span> <a href="2key_upgradability_Upgradeable.html">Upgradeable</a><span>, </span><a href="2key_singleton-contracts_ITwoKeySingletonUtils.html">ITwoKeySingletonUtils</a></p><div class="source">Source: <a href="https://github.com/2keynet/web3-alpha/blob/v0.0.3/contracts/2key/singleton-contracts/TwoKeyUpgradableExchange.sol" target="_blank">contracts/2key/singleton-contracts/TwoKeyUpgradableExchange.sol</a></div></div><div class="index"><h2>Index</h2><ul><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#TokenPurchase">TokenPurchase</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#TokenSell">TokenSell</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#WithdrawExecuted">WithdrawExecuted</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#_deliverTokens">_deliverTokens</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#_forwardFunds">_forwardFunds</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#_getTokenAmountToBeSold">_getTokenAmountToBeSold</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#_getUSDStableCoinAmountFrom2keyUnits">_getUSDStableCoinAmountFrom2keyUnits</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#_processPurchase">_processPurchase</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#addNewContract">addNewContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#buy2KEYFromBancor">buy2KEYFromBancor</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#buyStableCoinWith2key">buyStableCoinWith2key</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#buyTokens">buyTokens</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#calculatePercentageToDeduct">calculatePercentageToDeduct</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#calculateRatioBetweenDAIandETH">calculateRatioBetweenDAIandETH</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#calculateSumOnAllContracts">calculateSumOnAllContracts</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#daiWeiAvailableToFill2KEYReserve">daiWeiAvailableToFill2KEYReserve</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#daiWeiAvailableToWithdraw">daiWeiAvailableToWithdraw</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#daiWeiReceivedFromHedgingPerContract">daiWeiReceivedFromHedgingPerContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#emitEventWithdrawExecuted">emitEventWithdrawExecuted</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#ethReceivedFromContract">ethReceivedFromContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#ethWeiAvailableToHedge">ethWeiAvailableToHedge</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#ethWeiHedgedPerContract">ethWeiHedgedPerContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#">fallback</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#get2KEY2DAIHedgedRate">get2KEY2DAIHedgedRate</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getAddress">getAddress</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getAllStatsForContract">getAllStatsForContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getBool">getBool</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getContractId">getContractId</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getDaiWeiAvailableToWithdrawAndDaiWeiToReduce">getDaiWeiAvailableToWithdrawAndDaiWeiToReduce</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getEth2DaiAverageExchangeRatePerContract">getEth2DaiAverageExchangeRatePerContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getEth2KeyAverageRatePerContract">getEth2KeyAverageRatePerContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getKyberExpectedRate">getKyberExpectedRate</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#getUint">getUint</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#numberOfContracts">numberOfContracts</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#onlyValidatedContracts">onlyValidatedContracts</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#reduceDaiWeiAvailableToWithdraw">reduceDaiWeiAvailableToWithdraw</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#reduceHedgedAmountFromContractsAndIncreaseDaiAvailable">reduceHedgedAmountFromContractsAndIncreaseDaiAvailable</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#report2KEYWithdrawnFromNetwork">report2KEYWithdrawnFromNetwork</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#report2KEYWithdrawnFromNetworkInternal">report2KEYWithdrawnFromNetworkInternal</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#sellRate2key">sellRate2key</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#sent2keyToContract">sent2keyToContract</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#setAddress">setAddress</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#setBool">setBool</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#setInitialParams">setInitialParams</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#setUint">setUint</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#spreadWei">spreadWei</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#startHedging">startHedging</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#updateAccountingValues">updateAccountingValues</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#updateEthWeiAvailableToHedge">updateEthWeiAvailableToHedge</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#weiRaised">weiRaised</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#withdrawERC20">withdrawERC20</a></li><li><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#withdrawEther">withdrawEther</a></li></ul></div><div class="reference"><h2>Reference</h2><div class="events"><h3>Events</h3><ul><li><div class="item event"><span id="TokenPurchase" class="anchor-marker"></span><h4 class="name">TokenPurchase</h4><div class="body"><code class="signature">event <strong>TokenPurchase</strong><span>(address purchaser, address receiver, uint256 weiReceived, uint256 tokensBought, uint256 rate) </span></code><hr/><div class="description"><p>Event for token purchase logging.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>purchaser</code> - who paid for the tokens</div><div><code>receiver</code> - is who got the tokens</div><div><code>weiReceived</code> - is how weis paid for purchase</div><div><code>tokensBought</code> - is the amount of tokens purchased</div><div><code>rate</code> - is the global variable rate on the contract</div></dd></dl></div></div></li><li><div class="item event"><span id="TokenSell" class="anchor-marker"></span><h4 class="name">TokenSell</h4><div class="body"><code class="signature">event <strong>TokenSell</strong><span>(address purchaser, address beneficiary, uint256 value, uint256 amount) </span></code><hr/><div class="description"><p>Event will be fired every time someone buys tokens.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>purchaser</code> - address</div><div><code>beneficiary</code> - address</div><div><code>value</code> - uint256</div><div><code>amount</code> - uint256</div></dd></dl></div></div></li><li><div class="item event"><span id="WithdrawExecuted" class="anchor-marker"></span><h4 class="name">WithdrawExecuted</h4><div class="body"><code class="signature">event <strong>WithdrawExecuted</strong><span>(address caller, address beneficiary, uint stableCoinsReserveBefore, uint stableCoinsReserveAfter, uint etherBalanceBefore, uint etherBalanceAfter, uint stableCoinsToWithdraw, uint twoKeyAmount) </span></code><hr/><div class="description"><p>This event will be fired every time a withdraw is executed.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>caller</code> - address</div><div><code>beneficiary</code> - address</div><div><code>stableCoinsReserveBefore</code> - uint</div><div><code>stableCoinsReserveAfter</code> - uint</div><div><code>etherBalanceBefore</code> - uint</div><div><code>etherBalanceAfter</code> - uint</div><div><code>stableCoinsToWithdraw</code> - uint</div><div><code>twoKeyAmount</code> - uint</div></dd></dl></div></div></li></ul></div><div class="modifiers"><h3>Modifiers</h3><ul><li><div class="item modifier"><span id="onlyValidatedContracts" class="anchor-marker"></span><h4 class="name">onlyValidatedContracts</h4><div class="body"><code class="signature">modifier <strong>onlyValidatedContracts</strong><span>() </span></code><hr/><div class="description"><p>Modifier which will validate if contract is allowed to buy tokens.</p></div></div></div></li></ul></div><div class="functions"><h3>Functions</h3><ul><li><div class="item function"><span id="_deliverTokens" class="anchor-marker"></span><h4 class="name">_deliverTokens</h4><div class="body"><code class="signature">function <strong>_deliverTokens</strong><span>(address _beneficiary, uint256 _tokenAmount) </span><span>internal </span></code><hr/><div class="description"><p>Source of tokens. Override this method to modify the way in which the crowdsale ultimately gets and sends its tokens.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_beneficiary</code> - Address performing the token purchase</div><div><code>_tokenAmount</code> - Number of tokens to be emitted</div></dd></dl></div></div></li><li><div class="item function"><span id="_forwardFunds" class="anchor-marker"></span><h4 class="name">_forwardFunds</h4><div class="body"><code class="signature">function <strong>_forwardFunds</strong><span>(address _twoKeyAdmin) </span><span>internal </span></code><hr/><div class="description"><p>Determines how ETH is stored/forwarded on purchases.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_twoKeyAdmin</code> - address</div></dd></dl></div></div></li><li><div class="item function"><span id="_getTokenAmountToBeSold" class="anchor-marker"></span><h4 class="name">_getTokenAmountToBeSold</h4><div class="body"><code class="signature">function <strong>_getTokenAmountToBeSold</strong><span>(uint256 _weiAmount) </span><span>internal </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>Override to extend the way in which ether is converted to tokens.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_weiAmount</code> - Value in wei to be converted into tokens</div></dd><dt><span class="label-return">Returns:</span></dt><dd>Number of tokens that can be purchased with the specified _weiAmount</dd></dl></div></div></li><li><div class="item function"><span id="_getUSDStableCoinAmountFrom2keyUnits" class="anchor-marker"></span><h4 class="name">_getUSDStableCoinAmountFrom2keyUnits</h4><div class="body"><code class="signature">function <strong>_getUSDStableCoinAmountFrom2keyUnits</strong><span>(uint256 _2keyAmount, address _campaign) </span><span>public </span><span>view </span><span>returns  (uint256) </span></code><hr/><div class="description"><p>This is happening in case we&#x27;re receiving (buying) 2key, Function to calculate how many stable coins we can get for specific amount of 2keys.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_2keyAmount</code> - is the amount of 2keys sent to the contract</div><div><code>_campaign</code> - address</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint256</dd></dl></div></div></li><li><div class="item function"><span id="_processPurchase" class="anchor-marker"></span><h4 class="name">_processPurchase</h4><div class="body"><code class="signature">function <strong>_processPurchase</strong><span>(address _beneficiary, uint256 _tokenAmount) </span><span>internal </span></code><hr/><div class="description"><p>Executed when a purchase has been validated and is ready to be executed. Not necessarily emits/sends tokens.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_beneficiary</code> - Address receiving the tokens</div><div><code>_tokenAmount</code> - Number of tokens to be purchased</div></dd></dl></div></div></li><li><div class="item function"><span id="addNewContract" class="anchor-marker"></span><h4 class="name">addNewContract</h4><div class="body"><code class="signature">function <strong>addNewContract</strong><span>(address _contractAddress) </span><span>internal </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to register new contract with corresponding ID.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractAddress</code> - is the address of the contract we&#x27;re adding</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="buy2KEYFromBancor" class="anchor-marker"></span><h4 class="name">buy2KEYFromBancor</h4><div class="body"><code class="signature">function <strong>buy2KEYFromBancor</strong><span>(uint amountDAI, uint amount2KEY) </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Function to buy 2key tokens from Bancor.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="2key_singleton-contracts_ITwoKeySingletonUtils.html#onlyMaintainer">onlyMaintainer </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>amountDAI</code> - we&#x27;re willing to send (daiWeiAvailableToFill2keyReserve)</div><div><code>amount2KEY</code> - the minimum amount of 2KEY that is acceptable in return</div></dd></dl></div></div></li><li><div class="item function"><span id="buyStableCoinWith2key" class="anchor-marker"></span><h4 class="name">buyStableCoinWith2key</h4><div class="body"><code class="signature">function <strong>buyStableCoinWith2key</strong><span>(uint _twoKeyUnits, address _beneficiary) </span><span>external </span></code><hr/><div class="description"><p>Function which will be called by 2key campaigns if user wants to withdraw his earnings in stableCoins.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#onlyValidatedContracts">onlyValidatedContracts </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_twoKeyUnits</code> - is the amount of 2key tokens which will be taken from campaign</div><div><code>_beneficiary</code> - is the user who will receive the tokens</div></dd></dl></div></div></li><li><div class="item function"><span id="buyTokens" class="anchor-marker"></span><h4 class="name">buyTokens</h4><div class="body"><code class="signature">function <strong>buyTokens</strong><span>(address _beneficiary) </span><span>public </span><span>payable </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to buyTokens.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#onlyValidatedContracts">onlyValidatedContracts </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_beneficiary</code> - to get</div></dd><dt><span class="label-return">Returns:</span></dt><dd>amount of tokens bought</dd></dl></div></div></li><li><div class="item function"><span id="calculatePercentageToDeduct" class="anchor-marker"></span><h4 class="name">calculatePercentageToDeduct</h4><div class="body"><code class="signature">function <strong>calculatePercentageToDeduct</strong><span>(uint _ethWeiHedged, uint _sumOfAmounts) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to calculate how much pnercentage will be deducted from values.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_ethWeiHedged</code> - uint</div><div><code>_sumOfAmounts</code> - uint</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="calculateRatioBetweenDAIandETH" class="anchor-marker"></span><h4 class="name">calculateRatioBetweenDAIandETH</h4><div class="body"><code class="signature">function <strong>calculateRatioBetweenDAIandETH</strong><span>(uint _ethWeiHedged, uint _daiReceived) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to calculate ratio between eth and dai in WEI&#x27;s.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_ethWeiHedged</code> - uint</div><div><code>_daiReceived</code> - uint</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="calculateSumOnAllContracts" class="anchor-marker"></span><h4 class="name">calculateSumOnAllContracts</h4><div class="body"><code class="signature">function <strong>calculateSumOnAllContracts</strong><span>(uint _numberOfContractsCurrently) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to calculate available to hedge sum on all contracts.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_numberOfContractsCurrently</code> - uint</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="daiWeiAvailableToFill2KEYReserve" class="anchor-marker"></span><h4 class="name">daiWeiAvailableToFill2KEYReserve</h4><div class="body"><code class="signature">function <strong>daiWeiAvailableToFill2KEYReserve</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><dl><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="daiWeiAvailableToWithdraw" class="anchor-marker"></span><h4 class="name">daiWeiAvailableToWithdraw</h4><div class="body"><code class="signature">function <strong>daiWeiAvailableToWithdraw</strong><span>(uint _contractID) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Getter for mapping &quot;daiWeiAvailableToWithdraw&quot; (per contract).</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - uint</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="daiWeiReceivedFromHedgingPerContract" class="anchor-marker"></span><h4 class="name">daiWeiReceivedFromHedgingPerContract</h4><div class="body"><code class="signature">function <strong>daiWeiReceivedFromHedgingPerContract</strong><span>(uint _contractID) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to determine how many dai received from hedging per contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="emitEventWithdrawExecuted" class="anchor-marker"></span><h4 class="name">emitEventWithdrawExecuted</h4><div class="body"><code class="signature">function <strong>emitEventWithdrawExecuted</strong><span>(address _beneficiary, uint _stableCoinsOnContractBefore, uint _stableCoinsAfter, uint _etherBalanceOnContractBefore, uint _stableCoinUnits, uint twoKeyUnits) </span><span>internal </span></code><hr/><div class="description"><p>Function to emit an event, created separately because of stack depth.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_beneficiary</code> - address</div><div><code>_stableCoinsOnContractBefore</code> - uint</div><div><code>_stableCoinsAfter</code> - uint</div><div><code>_etherBalanceOnContractBefore</code> - uint</div><div><code>_stableCoinUnits</code> - uint</div><div><code>twoKeyUnits</code> - uint</div></dd></dl></div></div></li><li><div class="item function"><span id="ethReceivedFromContract" class="anchor-marker"></span><h4 class="name">ethReceivedFromContract</h4><div class="body"><code class="signature">function <strong>ethReceivedFromContract</strong><span>(uint _contractID) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get eth received from contract for specific contract ID.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="ethWeiAvailableToHedge" class="anchor-marker"></span><h4 class="name">ethWeiAvailableToHedge</h4><div class="body"><code class="signature">function <strong>ethWeiAvailableToHedge</strong><span>(uint _contractID) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Getter for &quot;mapping&quot; ethWeiAvailableToHedge (per contract).</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - uint</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="ethWeiHedgedPerContract" class="anchor-marker"></span><h4 class="name">ethWeiHedgedPerContract</h4><div class="body"><code class="signature">function <strong>ethWeiHedgedPerContract</strong><span>(uint _contractID) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get how much ethWei hedged per contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="fallback" class="anchor-marker"></span><h4 class="name">fallback</h4><div class="body"><code class="signature">function <strong></strong><span>() </span><span>public </span><span>payable </span></code><hr/><div class="description"><p>Fallback function to handle incoming ether.</p></div></div></div></li><li><div class="item function"><span id="get2KEY2DAIHedgedRate" class="anchor-marker"></span><h4 class="name">get2KEY2DAIHedgedRate</h4><div class="body"><code class="signature">function <strong>get2KEY2DAIHedgedRate</strong><span>(uint _contractID) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get 2key to DAI hedged rate.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re fetching this rate (avg)</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getAddress" class="anchor-marker"></span><h4 class="name">getAddress</h4><div class="body"><code class="signature">function <strong>getAddress</strong><span>(bytes32 key) </span><span>internal </span><span>view </span><span>returns  (address) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div></dd><dt><span class="label-return">Returns:</span></dt><dd>address</dd></dl></div></div></li><li><div class="item function"><span id="getAllStatsForContract" class="anchor-marker"></span><h4 class="name">getAllStatsForContract</h4><div class="body"><code class="signature">function <strong>getAllStatsForContract</strong><span>(address _contractAddress) </span><span>public </span><span>view </span><span>returns  (uint, uint, uint, uint, uint, uint) </span></code><hr/><div class="description"><p>Getter wrapping all information about income/outcome for every contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractAddress</code> - is the main campaign address</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd><dd>uint</dd><dd>uint</dd><dd>uint</dd><dd>uint</dd><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getBool" class="anchor-marker"></span><h4 class="name">getBool</h4><div class="body"><code class="signature">function <strong>getBool</strong><span>(bytes32 key) </span><span>internal </span><span>view </span><span>returns  (bool) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div></dd><dt><span class="label-return">Returns:</span></dt><dd>bool</dd></dl></div></div></li><li><div class="item function"><span id="getContractId" class="anchor-marker"></span><h4 class="name">getContractId</h4><div class="body"><code class="signature">function <strong>getContractId</strong><span>(address _contractAddress) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get contract id, if return 0 means contract is not existing.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractAddress</code> - address</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getDaiWeiAvailableToWithdrawAndDaiWeiToReduce" class="anchor-marker"></span><h4 class="name">getDaiWeiAvailableToWithdrawAndDaiWeiToReduce</h4><div class="body"><code class="signature">function <strong>getDaiWeiAvailableToWithdrawAndDaiWeiToReduce</strong><span>(uint _contractID, uint amountOfTokensWithdrawn) </span><span>internal </span><span>view </span><span>returns  (uint, uint) </span></code><hr/><div class="description"><p>Internal helper function.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the id of the contract we&#x27;d like to do the math</div><div><code>amountOfTokensWithdrawn</code> - is the amount of tokens withdrawn from campaign</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getEth2DaiAverageExchangeRatePerContract" class="anchor-marker"></span><h4 class="name">getEth2DaiAverageExchangeRatePerContract</h4><div class="body"><code class="signature">function <strong>getEth2DaiAverageExchangeRatePerContract</strong><span>(uint _contractID) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get Eth2DAI average exchange rate per contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getEth2KeyAverageRatePerContract" class="anchor-marker"></span><h4 class="name">getEth2KeyAverageRatePerContract</h4><div class="body"><code class="signature">function <strong>getEth2KeyAverageRatePerContract</strong><span>(uint _contractID) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get Eth22key average exchange rate per contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="getKyberExpectedRate" class="anchor-marker"></span><h4 class="name">getKyberExpectedRate</h4><div class="body"><code class="signature">function <strong>getKyberExpectedRate</strong><span>(uint amountEthWei) </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get expected rate from Kyber contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>amountEthWei</code> - is the amount we&#x27;d like to exchange</div></dd><dt><span class="label-return">Returns:</span></dt><dd>if the value is 0 that means we can&#x27;t</dd></dl></div></div></li><li><div class="item function"><span id="getUint" class="anchor-marker"></span><h4 class="name">getUint</h4><div class="body"><code class="signature">function <strong>getUint</strong><span>(bytes32 key) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="numberOfContracts" class="anchor-marker"></span><h4 class="name">numberOfContracts</h4><div class="body"><code class="signature">function <strong>numberOfContracts</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to return number of campaign contracts (different) interacted with this contract.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="reduceDaiWeiAvailableToWithdraw" class="anchor-marker"></span><h4 class="name">reduceDaiWeiAvailableToWithdraw</h4><div class="body"><code class="signature">function <strong>reduceDaiWeiAvailableToWithdraw</strong><span>(address contractAddress, uint daiAmount) </span><span>internal </span></code><hr/><div class="description"><p>Function to reduce amount of dai available to be withdrawn from selected contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>contractAddress</code> - is the address of the contract</div><div><code>daiAmount</code> - is the amount of dais</div></dd></dl></div></div></li><li><div class="item function"><span id="reduceHedgedAmountFromContractsAndIncreaseDaiAvailable" class="anchor-marker"></span><h4 class="name">reduceHedgedAmountFromContractsAndIncreaseDaiAvailable</h4><div class="body"><code class="signature">function <strong>reduceHedgedAmountFromContractsAndIncreaseDaiAvailable</strong><span>(uint _ethWeiHedged, uint _daiReceived) </span><span>internal </span></code><hr/><div class="description"><p>Function to reduce available amount to hedge and increase available DAI to withdraw.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_ethWeiHedged</code> - is how much eth was hedged</div><div><code>_daiReceived</code> - is how much DAI&#x27;s we got for that hedging</div></dd></dl></div></div></li><li><div class="item function"><span id="report2KEYWithdrawnFromNetwork" class="anchor-marker"></span><h4 class="name">report2KEYWithdrawnFromNetwork</h4><div class="body"><code class="signature">function <strong>report2KEYWithdrawnFromNetwork</strong><span>(uint amountOfTokensWithdrawn) </span><span>public </span></code><hr/><div class="description"><p>Function which will be called every time by campaign when referrer select to withdraw directly 2key token.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="2key_singleton-contracts_TwoKeyUpgradableExchange.html#onlyValidatedContracts">onlyValidatedContracts </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>amountOfTokensWithdrawn</code> - is the amount of tokens he wants to withdraw</div></dd></dl></div></div></li><li><div class="item function"><span id="report2KEYWithdrawnFromNetworkInternal" class="anchor-marker"></span><h4 class="name">report2KEYWithdrawnFromNetworkInternal</h4><div class="body"><code class="signature">function <strong>report2KEYWithdrawnFromNetworkInternal</strong><span>(uint amountOfTokensWithdrawn, uint _contractID) </span><span>public </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>amountOfTokensWithdrawn</code> - is the amount of tokens he wants to withdraw</div><div><code>_contractID</code> - is the id of the contract</div></dd></dl></div></div></li><li><div class="item function"><span id="sellRate2key" class="anchor-marker"></span><h4 class="name">sellRate2key</h4><div class="body"><code class="signature">function <strong>sellRate2key</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Getter for 2key sell rate.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="sent2keyToContract" class="anchor-marker"></span><h4 class="name">sent2keyToContract</h4><div class="body"><code class="signature">function <strong>sent2keyToContract</strong><span>(uint _contractID) </span><span>internal </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Function to get how many 2keys are sent to selected contract.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract we&#x27;re requesting information</div></dd><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="setAddress" class="anchor-marker"></span><h4 class="name">setAddress</h4><div class="body"><code class="signature">function <strong>setAddress</strong><span>(bytes32 key, address value) </span><span>internal </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div><div><code>value</code> - address</div></dd></dl></div></div></li><li><div class="item function"><span id="setBool" class="anchor-marker"></span><h4 class="name">setBool</h4><div class="body"><code class="signature">function <strong>setBool</strong><span>(bytes32 key, bool value) </span><span>internal </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div><div><code>value</code> - bool</div></dd></dl></div></div></li><li><div class="item function"><span id="setInitialParams" class="anchor-marker"></span><h4 class="name">setInitialParams</h4><div class="body"><code class="signature">function <strong>setInitialParams</strong><span>(ERC20 _token, address _daiAddress, address _kyberNetworkProxy, address _twoKeySingletonesRegistry, address _proxyStorageContract) </span><span>external </span></code><hr/><div class="description"><p>Constructor of the contract, can be called only once.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_token</code> - is ERC20 2key token</div><div><code>_daiAddress</code> - is the address of DAI on ropsten</div><div><code>_kyberNetworkProxy</code> - is the address of Kyber network contract</div><div><code>_twoKeySingletonesRegistry</code> - is the address of TWO_KEY_SINGLETON_REGISTRY</div><div><code>_proxyStorageContract</code> - is the address of proxy of storage contract</div></dd></dl></div></div></li><li><div class="item function"><span id="setUint" class="anchor-marker"></span><h4 class="name">setUint</h4><div class="body"><code class="signature">function <strong>setUint</strong><span>(bytes32 key, uint value) </span><span>internal </span></code><hr/><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>key</code> - bytes32</div><div><code>value</code> - uint</div></dd></dl></div></div></li><li><div class="item function"><span id="spreadWei" class="anchor-marker"></span><h4 class="name">spreadWei</h4><div class="body"><code class="signature">function <strong>spreadWei</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><dl><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="startHedging" class="anchor-marker"></span><h4 class="name">startHedging</h4><div class="body"><code class="signature">function <strong>startHedging</strong><span>(uint amountToBeHedged, uint approvedMinConversionRate) </span><span>public </span></code><hr/><div class="description"><p>Only maintainer can call this function, Function to start hedging some ether amount.</p></div><dl><dt><span class="label-modifiers">Modifiers:</span></dt><dd><a href="2key_singleton-contracts_ITwoKeySingletonUtils.html#onlyMaintainer">onlyMaintainer </a></dd><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>amountToBeHedged</code> - is the amount we&#x27;d like to hedge</div><div><code>approvedMinConversionRate</code> - uint</div></dd></dl></div></div></li><li><div class="item function"><span id="updateAccountingValues" class="anchor-marker"></span><h4 class="name">updateAccountingValues</h4><div class="body"><code class="signature">function <strong>updateAccountingValues</strong><span>(uint _daisReceived, uint _hedgedEthWei, uint _afterHedgingAvailableEthWei, uint _contractID) </span><span>internal </span></code><hr/><div class="description"><p>Internal function created to update specific values, separated because of stack depth.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_daisReceived</code> - is the amount of received dais</div><div><code>_hedgedEthWei</code> - is the amount of ethWei hedged</div><div><code>_afterHedgingAvailableEthWei</code> - is the amount available after hedging</div><div><code>_contractID</code> - is the ID of the contract</div></dd></dl></div></div></li><li><div class="item function"><span id="updateEthWeiAvailableToHedge" class="anchor-marker"></span><h4 class="name">updateEthWeiAvailableToHedge</h4><div class="body"><code class="signature">function <strong>updateEthWeiAvailableToHedge</strong><span>(uint _contractID, uint _msgValue) </span><span>internal </span></code><hr/><div class="description"><p>Setter for EthWeiAvailableToHedge.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_contractID</code> - is the ID of the contract</div><div><code>_msgValue</code> - is the amount sent</div></dd></dl></div></div></li><li><div class="item function"><span id="weiRaised" class="anchor-marker"></span><h4 class="name">weiRaised</h4><div class="body"><code class="signature">function <strong>weiRaised</strong><span>() </span><span>public </span><span>view </span><span>returns  (uint) </span></code><hr/><div class="description"><p>Getter for weiRaised.</p></div><dl><dt><span class="label-return">Returns:</span></dt><dd>uint</dd></dl></div></div></li><li><div class="item function"><span id="withdrawERC20" class="anchor-marker"></span><h4 class="name">withdrawERC20</h4><div class="body"><code class="signature">function <strong>withdrawERC20</strong><span>(address _erc20TokenAddress, uint _tokenAmount) </span><span>public </span></code><hr/><div class="description"><p>Function to withdraw any ERC20 tokens to TwoKeyAdmin.</p></div><dl><dt><span class="label-parameters">Parameters:</span></dt><dd><div><code>_erc20TokenAddress</code> - address</div><div><code>_tokenAmount</code> - uint</div></dd></dl></div></div></li><li><div class="item function"><span id="withdrawEther" class="anchor-marker"></span><h4 class="name">withdrawEther</h4><div class="body"><code class="signature">function <strong>withdrawEther</strong><span>() </span><span>public </span></code><hr/><div class="description"><p>Withdraw all ether from contract.</p></div></div></div></li></ul></div></div></div>
